{% extends "layout.html" %}

{% block content %}

<div class="container">
    <h2 class="text-center text-blue pt-5" >Registro</h2>

    <div id="login-row" class="row justify-content-center align-items-center">
        <div id="login-column" class="col-md-6">
            <div id="login-box" class="col-md-12">


                <form action="" class="needs-validation" novalidate method='POST'>
                    <div class="form-group">
                        <label for="uname">Usuario:</label>
                            <input type="text" class="form-control" id="uname" placeholder="Introduzca usuario" name="uname" required pattern="\w+"
                                {% if load_u %}
                                    value="{{ u.usuario }}"
                                {% endif %}
                            >
                        <div class="invalid-feedback" id="v_uname">Debe contener sólo letras, números, y guión "bajo".</div>
                    </div>

                    <div class="form-row">
                        <div class="col-md-6 mb-3">
                            <label for="nombre">Nombre:</label>
                            <input type="text" class="form-control" id="nombre" placeholder="Introduzca Nombre" name="nombre" required 
                                {% if load_u %}
                                    value="{{u.nombre}}"
                                {% endif %}
                            >
                            <div class="invalid-feedback">Por favor ingrese datos.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="apellidos">Apellidos:</label>
                            <input type="text" class="form-control" id="apellidos" placeholder="Introduzca Apellidos" name="apellidos" required 
                                {% if load_u %}
                                    value="{{u.apellidos}}"
                                {% endif %}
                            >
                            <div class="invalid-feedback">Por favor ingrese datos.</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="email">eMail:</label>
                        <input type="text" class="form-control" id="email" placeholder="Introduzca email" name="email" required pattern="^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$"
                                {% if load_u %}
                                    value="{{u.email}}"
                                {% endif %}
                        >
                        <div class="invalid-feedback" id="v_email">Debe ser una dirección correcta.</div>
                    </div>


                    {% if not load_u %}
                    <div class="form-row">
                        <div class="col-md-6 mb-3">
                            <label for="pwd">Password:</label>
                            <input type="password" class="form-control" id="pswd" title="" placeholder="Introduzca password" name="pswd" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}">                                                                                                                                                            
                            <div class="invalid-feedback">Debe contener al menos un número, una letra minúscula, una mayúscula y al menos 8 caracteres.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="pswd2">Confirme Password:</label>
                            <input type="password" class="form-control" title= "" id="pswd2" placeholder="Confirmación" name="pswd2" required oninput="validapswd2(this)"> 
                            <div class="invalid-feedback" id="v_pswd2">Error en confirmación.</div>
                        </div>
                    </div>
                    {% endif %}

                    <div class="form-group form-check">
                        <label class="form-check-label">
                            <input class="form-check-input" type="checkbox" name="auth" required checked> Autenticado
                            <div class="invalid-feedback">Marque el checkbox para continuar.</div>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary">Aceptar</button>
                </form>
            </div>
        </div>
    </div>

    {% if error %}
    <br>
    <div class="alert alert-danger alert-dismissible fade show">
        <strong>Error!</strong> {{ error }} 
        <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}

</div>

<script>
    // Disable form submissions if there are invalid fields
    (function() {
        'use strict';
        window.addEventListener('load', function() {
            // Get the forms we want to add validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function(form) {
                form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();



function checkp(input) {
        //alert(input.value);
      input.setCustomValidity('scv0');
    if (form.$pswd.value != input.value) {
        alert($pswd.value);
      input.setCustomValidity('scv');
      $("#v_pswd2").html("Error: Pasword NO coincide!");
    }
}
function validapswd2(input) {
    pswd = document.getElementById("pswd").value 
    if (pswd != input.value) {
      input.setCustomValidity('scv');
      $("#v_pswd2").html("Error: Pasword NO coincide!");
    } else {
      input.setCustomValidity('');
    }

}

</script>

{% endblock %}

