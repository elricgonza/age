{% extends "layout.html" %} {% block content %} {% block js_css %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css">        

<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.0.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.print.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.colVis.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.2.0/js/buttons.html5.styles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.2.0/js/buttons.html5.styles.templates.min.js"></script>

<style type="text/css">
    table th{
        background-color: #17a2b8;
        color: white;
    }
</style>
{% endblock %}
<!--sample-->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <form action="" novalidate method='POST' id='formhomologacion' name='formhomologacion'>
                <div class="row">
                    <br>
                    <div class="col-xs-12 col-sm-6 col-md-8">
                        <h5>Listado de Homologaciones</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-md-8">
                        <label class="float-left" for="fechadoc">Periodo de Búsqueda.:</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-1">
                    </div>
                    <div class="col-md-2">
                        <label class="float-right" for="fechadoc">Desde.:</label>
                    </div>
                    <div class="col-md-3 float-left">
                        <input type="date" class="form-control" id="iinicio" name="inicio" 
                                placeholder="Introduzca fecha de Búsqueda" name="inicio" min="2012-01-01" max="2035-01-01"
                                {% if load %}
                                    value="{{ inicio }}"  
                                {% endif %}
                            >
                        <div class="invalid-feedback" id="v_fechadoc">Debe introducir una fecha válida.</div>
                    </div>
                    <div class="col-md-1">
                        <label class="float-right" for="fechadoc">Hasta.:</label>
                    </div>
                    <div class="col-md-3 float-left">
                        <input type="date" class="form-control" id="ifinal" name="final" 
                                placeholder="Introduzca fecha de Búsqueda" name="final" min="2012-01-01" max="2035-01-01"
                                {% if load %}
                                    value="{{ final }}"  
                                {% endif %}
                            >
                        <div class="invalid-feedback" id="v_fechadoc">Debe introducir una fecha válida.</div>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary" onclick="pasa_homologacion()">Buscar</button>
                    </div>
                </div>      
            </form>
            <div style="height:20px"></div>
            <div class="table-responsive">
                <table id="id_dthomo" class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr style="font-size: 13px;">
                            <th>Dep</th>
                            <th>Prov</th>
                            <th>Sec</th>
                            <th>IdLoc</th>
                            <th>Dist</th>
                            <th>Zona</th>
                            <th>Reci</th>
                            <th>NomDep</th>
                            <th>NomProv</th>
                            <th>NomSec</th>
                            <th>NomLoc</th>
                            <th>NomDist</th>
                            <th>NomZona</th>                            
                            <th>NomReci</th>
                            <th>Direccion</th>
                            <th>Circun</th>
                            <th>TipoCircun</th>                            
                            <th>IdTipoRecinto</th>
                            <th>TipoRecinto</th>                            
                            <th>Dep</th>
                            <th>Prov</th>
                            <th>Sec</th>
                            <th>IdLoc</th>
                            <th>Dist</th>
                            <th>Zona</th>
                            <th>Reci</th>
                            <th>NomDep</th>
                            <th>NomProv</th>
                            <th>NomSec</th>
                            <th>NomLoc</th>
                            <th>NomDist</th>
                            <th>NomZona</th>                            
                            <th>NomReci</th>
                            <th>Direccion</th>
                            <th>Circun</th>
                            <th>TipoCircun</th>                            
                            <th>IdTipoRecinto</th>
                            <th>TipoRecinto</th>
                            <th>Acción</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for homologacion in homologaciones %}
                            <tr style="font-size: 13px;">
                                <td>{{ homologacion[1] }}</td>
                                <td>{{ homologacion[2] }}</td>
                                <td>{{ homologacion[3] }}</td>
                                <td>{{ homologacion[4] }}</td>
                                <td>{{ homologacion[5] }}</td>
                                <td>{{ homologacion[6] }}</td>
                                <td>{{ homologacion[7] }}</td>
                                <td>{{ homologacion[8] }}</td>
                                <td>{{ homologacion[9] }}</td>
                                <td>{{ homologacion[10] }}</td>
                                <td>{{ homologacion[11] }}</td>
                                <td>{{ homologacion[12] }}</td>
                                <td>{{ homologacion[13] }}</td>
                                <td>{{ homologacion[14] }}</td>
                                <td>{{ homologacion[15] }}</td>
                                <td>{{ homologacion[16] }}</td>
                                <td>{{ homologacion[17] }}</td>
                                <td>{{ homologacion[18] }}</td>
                                <td>{{ homologacion[19] }}</td>
                                <td>{{ homologacion[20] }}</td>
                                <td>{{ homologacion[21] }}</td>
                                <td>{{ homologacion[22] }}</td>
                                <td>{{ homologacion[23] }}</td>
                                <td>{{ homologacion[24] }}</td>
                                <td>{{ homologacion[25] }}</td>
                                <td>{{ homologacion[26] }}</td>
                                <td>{{ homologacion[27] }}</td>
                                <td>{{ homologacion[28] }}</td>
                                <td>{{ homologacion[29] }}</td>
                                <td>{{ homologacion[30] }}</td>
                                <td>{{ homologacion[31] }}</td>
                                <td>{{ homologacion[32] }}</td>
                                <td>{{ homologacion[33] }}</td>
                                <td>{{ homologacion[34] }}</td>
                                <td>{{ homologacion[35] }}</td>
                                <td>{{ homologacion[36] }}</td>
                                <td>{{ homologacion[37] }}</td>
                                <td>{{ homologacion[38] }}</td>                                
                                <td style="text-align: center; font-size: 20px;">
                                    {% if puede_consultar %}
                                        <a href={{ url_for( 'homologacion', idhomo=homologacion[0], inicio=inicio, final=final) }}><i class="fas fa-search-plus"></i></a>
                                    {% else %}
                                        <i class="fas fa-search-plus" style="color: grey"></i>
                                    {% endif%}
                                </td>
                            </tr>
                        {% endfor %}
                        {% for homojurisd in homojurisds %}
                            <tr style="font-size: 13px;">
                                <td>{{ homojurisd[1] }}</td>
                                <td>{{ homojurisd[2] }}</td>
                                <td>{{ homojurisd[3] }}</td>
                                <td>{{ homojurisd[4] }}</td>
                                <td>{{ homojurisd[5] }}</td>
                                <td>{{ homojurisd[6] }}</td>
                                <td>{{ homojurisd[7] }}</td>
                                <td>{{ homojurisd[8] }}</td>
                                <td>{{ homojurisd[9] }}</td>
                                <td>{{ homojurisd[10] }}</td>
                                <td>{{ homojurisd[11] }}</td>
                                <td>{{ homojurisd[12] }}</td>
                                <td>{{ homojurisd[13] }}</td>
                                <td>{{ homojurisd[14] }}</td>
                                <td>{{ homojurisd[15] }}</td>
                                <td>{{ homojurisd[16] }}</td>
                                <td>{{ homojurisd[17] }}</td>
                                <td>{{ homojurisd[18] }}</td>
                                <td>{{ homojurisd[19] }}</td>
                                <td>{{ homojurisd[20] }}</td>
                                <td>{{ homojurisd[21] }}</td>
                                <td>{{ homojurisd[22] }}</td>
                                <td>{{ homojurisd[23] }}</td>
                                <td>{{ homojurisd[24] }}</td>
                                <td>{{ homojurisd[25] }}</td>
                                <td>{{ homojurisd[26] }}</td>
                                <td>{{ homojurisd[27] }}</td>
                                <td>{{ homojurisd[28] }}</td>
                                <td>{{ homojurisd[29] }}</td>
                                <td>{{ homojurisd[30] }}</td>
                                <td>{{ homojurisd[31] }}</td>
                                <td>{{ homojurisd[32] }}</td>
                                <td>{{ homojurisd[33] }}</td>
                                <td>{{ homojurisd[34] }}</td>
                                <td>{{ homojurisd[35] }}</td>
                                <td>{{ homojurisd[36] }}</td>
                                <td>{{ homojurisd[37] }}</td>
                                <td>{{ homojurisd[38] }}</td>                                
                                <td style="text-align: center; font-size: 20px;">
                                    {% if puede_consultar %}
                                        (j)<a href={{ url_for( 'homojurisd', idhomo=homojurisd[0], inicio=inicio, final=final) }}><i class="fas fa-search-plus"></i></a>
                                    {% else %}
                                        <i class="fas fa-search-plus" style="color: grey"></i>
                                    {% endif%}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $("#id_dthomo").DataTable({
        "columnDefs": [
            {
                "targets": [ 0 ],
                "visible": false,
                "searchable": false
            },
            {
                "targets": [ 1 ],
                "visible": false
            },
            {
                "targets": [ 2 ],
                "visible": false
            },
            {
                "targets": [ 4 ],
                "visible": false
            },
            {
                "targets": [ 5 ],
                "visible": false
            },            
            {
                "targets": [ 8 ],
                "visible": false
            },
            {
                "targets": [ 9 ],
                "visible": false
            },
            {
                "targets": [ 11 ],
                "visible": false
            },
            {
                "targets": [ 12 ],
                "visible": false
            },
            {
                "targets": [ 14 ],
                "visible": false
            },
            {
                "targets": [ 15 ],
                "visible": false
            },
            {
                "targets": [ 16 ],
                "visible": false
            },
            {
                "targets": [ 17 ],
                "visible": false
            },
            {
                "targets": [ 18 ],
                "visible": false
            },
            {
                "targets": [ 19 ],
                "visible": false
            },
            {
                "targets": [ 20 ],
                "visible": false
            },
            {
                "targets": [ 21 ],
                "visible": false
            },
            {
                "targets": [ 23 ],
                "visible": false
            },
            {
                "targets": [ 24 ],
                "visible": false
            },
            {
                "targets": [ 26 ],
                "visible": false
            },
            {
                "targets": [ 27 ],
                "visible": false
            },
            {
                "targets": [ 28 ],
                "visible": false
            },
            {
                "targets": [ 29 ],
                "visible": false
            },
            {
                "targets": [ 30 ],
                "visible": false
            },
            {
                "targets": [ 31 ],
                "visible": false
            },
            {
                "targets": [ 33 ],
                "visible": false
            },
            {
                "targets": [ 34 ],
                "visible": false
            },
            {
                "targets": [ 35 ],
                "visible": false
            },
            {
                "targets": [ 36 ],
                "visible": false
            }
        ],
        dom: "Bfrtip",
        buttons:{
            dom:{
                button:{
                    className: 'btn'
                }
            },
            buttons:[
                {
                    extend: 'excel',
                    messageTop: 'Documento de Homologación por cambios de Geografía',
                    text: 'Exportar a Excel',
                    className: 'btn btn-outline-success',
                    excelStyles: [                      
                        {                 
                            template: "green_medium",   
                        },
                        {
                            cells: "sh",                
                            style: {                    
                                font: {                 
                                    size: 12,           
                                    b: false,           
                                },
                                fill: {                 
                                    pattern: {          
                                        color: "1C3144" 
                                    }
                                }
                            }
                        }
                    ]       
                }
            ]
        }
    });
    function pasa_homologacion(){
        $("#iinicio").val();
        $("#ifinal").val();
        $('#formhomologacion').attr('action', '/homologacion_list');    
    }
    function pasa_homologacion_r(){
        $("#iinicio").val();
        $("#ifinal").val();
        $('#formhomologacion').attr('action', '/homologacion_pdf').submit();    
    }
</script>

{% endblock %}
